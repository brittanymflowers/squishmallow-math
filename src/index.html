<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Squishmallow Collector - Math Adventure</title>

    <!-- Favicon - will be updated dynamically -->
    <link
      rel="icon"
      type="image/png"
      id="favicon"
      href="assets/squishmallows/luna_the_cat.png"
    />

    <!-- Preload critical fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Google Fonts for child-friendly typography -->
    <link
      href="https://fonts.googleapis.com/css2?family=Fredoka+One:wght@400&family=Quicksand:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <!-- Main stylesheet -->
    <link rel="stylesheet" href="css/main.css" />

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  </head>
  <body>
    <!-- Main application container -->
    <div id="app">
      <!-- Loading screen (shown first) -->
      <div id="loading-screen" class="screen active">
        <div class="loading-content">
          <div class="squishmallow-mascot">
            <img
              src="assets/squishmallows/luna_the_cat.png"
              alt="Adorable Luna the Cat Squishmallow"
              class="mascot-image"
            />
          </div>
          <h1 class="game-title">Squishmallow Collector</h1>
          <h2 class="subtitle">Math Adventure Loading...</h2>
          <div class="loading-spinner">
            <div class="spinner"></div>
          </div>
        </div>
      </div>

      <!-- Dashboard screen (hidden initially, will be shown in Story 1.3) -->
      <div id="dashboard-screen" class="screen">
        <div class="dashboard-content">
          <div class="squishmallow-mascot">
            <img
              id="dashboard-mascot"
              src="assets/squishmallows/luna_the_cat.png"
              alt="Click to change your dashboard companion"
              class="mascot-image small clickable-mascot"
              title="Click to choose your dashboard companion"
            />
          </div>
          <h1 class="game-title">Squishmallow Collector</h1>
          <h2 class="subtitle">Math Adventure</h2>

          <!-- Dashboard Navigation Buttons -->
          <div class="button-container">
            <button id="start-game-btn" class="dashboard-button primary">
              <span class="button-icon"><i data-lucide="gamepad-2"></i></span>
              <span class="button-text">Start New Game</span>
              <span class="button-subtitle">Begin your math adventure!</span>
            </button>

            <button id="view-collection-btn" class="dashboard-button secondary">
              <span class="button-icon"><i data-lucide="book-open"></i></span>
              <span class="button-text">View Collection</span>
              <span class="button-subtitle">See your Squishmallows</span>
            </button>

            <button id="create-studio-btn" class="dashboard-button creative">
              <span class="button-icon"><i data-lucide="palette"></i></span>
              <span class="button-text">Create Studio</span>
              <span class="button-subtitle"
                >Design your own Squishmallows!</span
              >
            </button>

            <button id="settings-btn" class="dashboard-button tertiary">
              <span class="button-icon"><i data-lucide="settings"></i></span>
              <span class="button-text">Settings</span>
              <span class="button-subtitle">Adjust game options</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Game screen (Story 2.2: Basic Game Screen Layout) -->
      <div id="game-screen" class="screen">
        <button id="back-to-dashboard-btn" class="back-button">
          <i data-lucide="arrow-left"></i> Back to Dashboard
        </button>

        <button
          id="game-mute-btn"
          class="mute-button"
          title="Toggle sound on/off"
        >
          <span class="button-icon">
            <i data-lucide="volume-2" id="mute-icon-on"></i>
            <i
              data-lucide="volume-x"
              id="mute-icon-off"
              style="display: none"
            ></i>
          </span>
        </button>

        <div class="game-content">
          <!-- Game Header -->
          <div class="game-header"></div>

          <!-- Left Column: Problem and Progress -->
          <div class="game-left-column">
            <!-- Squishmallow Progress Indicator -->
            <div class="squishmallow-progress">
              <div class="progress-stats">
                <div class="progress-encouragement" id="progress-encouragement">
                  Great job!
                </div>
                <div class="progress-text" id="progress-text">
                  0 out of 10 complete!
                </div>
                <div class="lives-container" id="lives-container">
                  <span class="lives-label">Lives:</span>
                  <div class="lives-display" id="lives-display">
                    <i
                      data-lucide="heart"
                      class="life-icon filled"
                      id="life-1"
                    ></i>
                    <i
                      data-lucide="heart"
                      class="life-icon filled"
                      id="life-2"
                    ></i>
                    <i
                      data-lucide="heart"
                      class="life-icon filled"
                      id="life-3"
                    ></i>
                  </div>
                </div>
              </div>
              <div class="squishmallow-outline">
                <div class="squishmallow-fill" id="squishmallow-fill"></div>
              </div>
            </div>

            <!-- Math Problem Display Area -->
            <div class="problem-container">
              <div class="problem-display">
                <div class="problem-text" id="current-problem">3 Ã— 4 = ?</div>
              </div>
            </div>
          </div>

          <!-- Right Column: Answer Input and Number Pad -->
          <div class="game-right-column">
            <!-- Timer Display (Story 5.4) -->
            <div class="timer-wrapper" id="timer-wrapper" style="display: none">
              <div class="timer-container" id="timer-container">
                <i data-lucide="clock" class="timer-icon"></i>
                <span class="timer-display" id="timer-display">
                  <span class="timer-minutes">5</span>:<span
                    class="timer-seconds"
                    >00</span
                  >
                </span>
              </div>
            </div>

            <!-- Answer Input Area -->
            <div class="answer-container">
              <div class="answer-display">
                <label for="answer-input" class="answer-label"
                  >Your Answer:</label
                >
                <input
                  type="text"
                  id="answer-input"
                  class="answer-input"
                  placeholder="Enter answer..."
                  readonly
                />
              </div>
            </div>

            <!-- Number Pad -->
            <div class="number-pad-container">
              <div class="number-pad">
                <div class="number-grid">
                  <button class="number-btn" data-number="7">7</button>
                  <button class="number-btn" data-number="8">8</button>
                  <button class="number-btn" data-number="9">9</button>

                  <button class="number-btn" data-number="4">4</button>
                  <button class="number-btn" data-number="5">5</button>
                  <button class="number-btn" data-number="6">6</button>

                  <button class="number-btn" data-number="1">1</button>
                  <button class="number-btn" data-number="2">2</button>
                  <button class="number-btn" data-number="3">3</button>

                  <button class="action-btn clear" id="clear-btn">
                    <i data-lucide="x"></i>
                    <span class="button-text">Clear</span>
                  </button>
                  <button class="number-btn zero" data-number="0">0</button>
                  <button class="action-btn enter" id="enter-btn">
                    <i data-lucide="check"></i>
                    <span class="button-text">Enter</span>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Story 3.3: Success Screen -->
    <div class="screen" id="success-screen">
      <div class="screen-container">
        <div class="success-content">
          <div class="success-header">
            <h1 class="success-title">
              <i data-lucide="party-popper"></i> Congratulations!
              <i data-lucide="party-popper"></i>
            </h1>
            <p class="success-subtitle">You earned a new Squishmallow!</p>
          </div>

          <div class="reward-display">
            <div class="squishmallow-preview">
              <img
                id="earned-squishmallow-image"
                src="assets/squishmallows/luna_the_cat.png"
                alt="Luna the Cat"
                class="mascot-image earned-squishmallow"
              />
              <h3 id="earned-squishmallow-name" class="squishmallow-name">
                Luna the Cat
              </h3>
              <p id="earned-squad" class="squishmallow-squad">Magical Squad</p>
              <p id="earned-description" class="squishmallow-description">
                A wonderful new friend to add to your collection!
              </p>
            </div>
          </div>

          <div class="success-stats">
            <p class="stat-text">
              <i data-lucide="sparkles"></i> Problems Solved:
              <span id="final-correct-count">10</span>
            </p>
            <p class="stat-text">
              <i data-lucide="star"></i> Accuracy:
              <span id="final-accuracy">85%</span>
            </p>
          </div>

          <div class="success-buttons">
            <button class="back-button" id="success-dashboard-btn">
              <i data-lucide="arrow-left"></i> Back to Dashboard
            </button>
            <button
              class="dashboard-button secondary"
              id="success-collection-btn"
            >
              <span class="button-icon"><i data-lucide="book-open"></i></span>
              <span class="button-text">View Collection</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Story 3.3: Failure Screen -->
    <div class="screen" id="failure-screen">
      <div class="screen-container">
        <div class="failure-content">
          <div class="failure-header">
            <h1 class="failure-title">ðŸ˜Š Good Try!</h1>
            <p class="failure-subtitle">Let's practice more to get stronger!</p>
          </div>

          <div class="encouragement-display">
            <div class="mascot-encouragement">
              <img
                src="assets/squishmallows/luna_the_cat.png"
                alt="Luna the Cat"
                class="mascot-image encouraging"
              />
              <p class="encouragement-text">
                "You're doing great! Math takes practice, and you're getting
                better every time! <i data-lucide="sparkles"></i>"
              </p>
            </div>
          </div>

          <div class="failure-stats">
            <p class="stat-text">
              <i data-lucide="book-open"></i> Problems Attempted:
              <span id="failure-problem-count">7</span>
            </p>
            <p class="stat-text">
              <i data-lucide="check"></i> Correct Answers:
              <span id="failure-correct-count">4</span>
            </p>
            <p class="stat-text">
              <i data-lucide="target"></i> Keep practicing to earn your
              Squishmallow!
            </p>
          </div>

          <div class="failure-actions">
            <button class="dashboard-button primary" id="try-again-btn">
              <span class="button-icon"><i data-lucide="refresh-cw"></i></span>
              <span class="button-text">Try Again</span>
            </button>
            <button class="back-button" id="failure-dashboard-btn">
              <i data-lucide="arrow-left"></i> Back to Dashboard
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Story 4.2: Collection Screen -->
    <div class="screen" id="collection-screen">
      <div class="screen-container">
        <div class="collection-content">
          <div class="collection-title-section">
            <h1 class="collection-title">My Squishmallow Collection</h1>
            <p class="collection-subtitle">
              Keep practicing to collect them all!
            </p>
          </div>

          <div class="collection-stats">
            <button class="back-button" id="collection-dashboard-btn">
              <i data-lucide="arrow-left"></i> Back to Dashboard
            </button>

            <div class="stat-badge">
              <span class="stat-number" id="collected-count">0</span>
              <span class="stat-label">Collected</span>
            </div>
            <div class="stat-badge">
              <span class="stat-number" id="total-count">19</span>
              <span class="stat-label">Total</span>
            </div>
            <div class="stat-badge">
              <span class="stat-number" id="completion-percentage">0%</span>
              <span class="stat-label">Complete</span>
            </div>
          </div>

          <div class="collection-grid" id="collection-grid">
            <!-- Squishmallows will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Settings Screen -->
    <div class="screen" id="settings-screen">
      <div class="screen-container">
        <div class="settings-content">
          <div class="settings-header">
            <h1 class="settings-title">
              <i data-lucide="settings"></i> Game Settings
            </h1>
            <p class="settings-subtitle">
              Customize the game for your child's learning level
            </p>
          </div>

          <div class="settings-form">
            <div class="setting-section">
              <h3><i data-lucide="calculator"></i> Math Operations</h3>
              <div class="setting-group">
                <label class="setting-label">
                  <input
                    type="checkbox"
                    id="operation-addition"
                    value="addition"
                  />
                  <span class="checkbox-label">Addition (+)</span>
                </label>
                <label class="setting-label">
                  <input
                    type="checkbox"
                    id="operation-subtraction"
                    value="subtraction"
                  />
                  <span class="checkbox-label">Subtraction (âˆ’)</span>
                </label>
                <label class="setting-label">
                  <input
                    type="checkbox"
                    id="operation-multiplication"
                    value="multiplication"
                    checked
                  />
                  <span class="checkbox-label">Multiplication (Ã—)</span>
                </label>
                <label class="setting-label">
                  <input
                    type="checkbox"
                    id="operation-division"
                    value="division"
                  />
                  <span class="checkbox-label">Division (Ã·)</span>
                </label>
              </div>
              <p class="setting-description">
                Select one or more operations to practice
              </p>
            </div>

            <div class="setting-section">
              <h3><i data-lucide="hash"></i> Number Ranges</h3>
              <div class="setting-group">
                <div class="range-control">
                  <label class="setting-label">
                    Multiplication/Division - Highest times table:
                    <input
                      type="number"
                      id="mult-range"
                      min="5"
                      max="20"
                      value="12"
                      step="1"
                    />
                  </label>
                  <p class="setting-description">
                    Practices times tables up to this number (e.g., 8 = 0Ã—8
                    through 12Ã—8)
                  </p>
                </div>

                <div class="range-control">
                  <label class="setting-label">
                    Addition/Subtraction - Number size:
                    <select id="add-range">
                      <option value="ones">Ones (1-9)</option>
                      <option value="tens" selected>Tens (1-99)</option>
                      <option value="hundreds">Hundreds (1-999)</option>
                    </select>
                  </label>
                  <p class="setting-description">
                    Choose the size of numbers for addition and subtraction
                  </p>
                </div>
              </div>
            </div>

            <div class="setting-section">
              <h3><i data-lucide="clock"></i> Game Length</h3>
              <div class="setting-group">
                <label class="setting-label">
                  Problems to complete:
                  <select id="game-length-select">
                    <option value="5">5 problems</option>
                    <option value="10" selected>10 problems</option>
                    <option value="15">15 problems</option>
                    <option value="20">20 problems</option>
                  </select>
                </label>
              </div>
            </div>

            <div class="setting-section">
              <h3><i data-lucide="heart"></i> Lives System</h3>
              <div class="setting-group">
                <label class="setting-label">
                  <input type="checkbox" id="lives-enabled" checked />
                  <span class="checkbox-label">Enable 3-lives system</span>
                </label>
                <p class="setting-description">
                  When disabled, students can keep trying until they succeed
                </p>
              </div>
            </div>

            <div class="setting-section">
              <h3><i data-lucide="timer"></i> Timer Settings</h3>
              <div class="setting-group">
                <label class="setting-label">
                  Time limit per game:
                  <select id="timer-select">
                    <option value="0">No Limit</option>
                    <option value="60">1 minute</option>
                    <option value="180">3 minutes</option>
                    <option value="300">5 minutes</option>
                    <option value="600">10 minutes</option>
                  </select>
                </label>
                <p class="setting-description">
                  Choose a time limit or select "No Limit" for stress-free
                  practice
                </p>
              </div>
            </div>

            <div class="setting-section">
              <h3><i data-lucide="volume-2"></i> Audio Settings</h3>
              <div class="setting-group">
                <label class="setting-label">
                  <input type="checkbox" id="audio-enabled" checked />
                  Enable sound effects
                </label>
                <p class="setting-description">
                  Play sounds for correct answers, mistakes, and celebrations
                </p>

                <label class="setting-label">
                  Sound volume:
                  <input
                    type="range"
                    id="sound-volume"
                    min="0"
                    max="100"
                    value="50"
                    class="volume-slider"
                  />
                  <span id="sound-volume-display">50%</span>
                </label>

                <label class="setting-label">
                  <input
                    type="checkbox"
                    id="background-music-enabled"
                    checked
                  />
                  Enable background music
                </label>
                <p class="setting-description">
                  Play gentle background music during gameplay
                </p>

                <label class="setting-label">
                  Music volume:
                  <input
                    type="range"
                    id="music-volume"
                    min="0"
                    max="100"
                    value="30"
                    class="volume-slider"
                  />
                  <span id="music-volume-display">30%</span>
                </label>
              </div>
            </div>

            <div class="setting-section danger-section">
              <h3><i data-lucide="trash-2"></i> Reset Collection</h3>
              <div class="setting-group">
                <button
                  class="restart-collection-btn"
                  id="restart-collection-btn"
                >
                  <span class="button-icon"
                    ><i data-lucide="refresh-cw"></i
                  ></span>
                  <span class="button-text"
                    >Restart Squishmallow Collection</span
                  >
                </button>
                <p class="setting-description">
                  This will permanently delete all your collected Squishmallows
                  and start fresh
                </p>
              </div>
            </div>
          </div>

          <div class="settings-buttons">
            <button class="back-button" id="settings-cancel-btn">
              <i data-lucide="arrow-left"></i> Back to Dashboard
            </button>
            <button class="dashboard-button primary" id="settings-save-btn">
              <span class="button-icon"><i data-lucide="save"></i></span>
              <span class="button-text">Save Settings</span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Story 7.5: Template Selection Screen -->
    <div class="screen" id="template-selection-screen">
      <button class="back-button" id="template-back-btn">
        <i data-lucide="arrow-left"></i> Back to Dashboard
      </button>
      <button class="my-creations-button" id="my-creations-btn">
        <i data-lucide="image"></i> My Creations
      </button>
      <div class="screen-container">
        <div class="template-selection-content">
          <div class="template-selection-header">
            <h1 class="template-selection-title">Choose Your Template</h1>
            <p class="template-selection-subtitle">
              Select a Squishmallow outline to color and customize!
            </p>
          </div>

          <div class="template-selection-grid" id="template-selection-grid">
            <!-- Templates will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Story 7.5: Creator Studio Screen -->
    <div class="screen" id="create-studio-screen">
      <button class="back-button" id="creator-back-btn">
        <i data-lucide="arrow-left"></i> Back to Dashboard
      </button>
      <div class="screen-container">
        <div class="creator-content">
          <div class="creator-header">
            <h1 class="creator-title">Squishmallow Creator Studio</h1>
            <p class="creator-subtitle">
              Design your own custom Squishmallows with colors, patterns, and
              special effects!
            </p>
          </div>

          <div class="creator-workspace">
            <!-- Canvas Area -->
            <div class="canvas-section">
              <div class="canvas-header">
                <h3><i data-lucide="image"></i> Canvas</h3>
                <div class="canvas-controls">
                  <button id="switch-template-btn" class="tool-button" title="Switch Template">
                    <i data-lucide="file-pen"></i>
                  </button>
                  <button id="undo-btn" class="tool-button" title="Undo">
                    <i data-lucide="undo-2"></i>
                  </button>
                  <button id="redo-btn" class="tool-button" title="Redo">
                    <i data-lucide="redo-2"></i>
                  </button>
                  <button
                    id="canvas-clear-btn"
                    class="tool-button eraser"
                    title="Clear Canvas"
                  >
                    <i data-lucide="eraser"></i>
                  </button>
                </div>
              </div>
              <div class="canvas-container">
                <canvas id="creator-canvas" width="400" height="400"></canvas>
                <div id="template-overlay"></div>
              </div>
            </div>

            <!-- Tools Panel -->
            <div class="tools-section">
              <div class="tool-panel">
                <h3><i data-lucide="palette"></i> Colors</h3>
                <div class="color-picker" id="color-picker">
                  <!-- Colors will be populated by JavaScript -->
                </div>

                <div class="recent-colors-section">
                  <h4><i data-lucide="clock"></i> Recent Colors</h4>
                  <div class="recent-colors" id="recent-colors">
                    <!-- Recent colors will be populated by JavaScript -->
                  </div>
                </div>
              </div>

              <div class="tool-panel">
                <h3><i data-lucide="sparkles"></i> Patterns</h3>
                <div class="pattern-selector" id="pattern-selector">
                  <!-- Patterns will be populated by JavaScript -->
                </div>
              </div>

              <div class="tool-panel">
                <h3><i data-lucide="wand-2"></i> Special Effects</h3>
                <div class="effects-selector" id="effects-selector">
                  <!-- Effects will be populated by JavaScript -->
                </div>
              </div>
            </div>
          </div>

          <div class="creator-actions">
            <div class="creation-info">
              <input
                type="text"
                id="creation-name"
                placeholder="Name your creation (letters and numbers only)..."
                maxlength="15"
                class="creation-name-input"
                title="Use letters and numbers only (no spaces or special characters)"
              />
            </div>
            <div class="action-buttons">
              <button class="creator-button secondary" id="save-draft-btn">
                <i data-lucide="save"></i> Save Draft
              </button>
              <button class="creator-button primary" id="finish-creation-btn">
                <i data-lucide="check"></i> Finish Creation
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Story 7.5: My Creations Screen -->
    <div class="screen" id="my-creations-screen">
      <button class="back-button" id="creations-dashboard-btn">
        <i data-lucide="arrow-left"></i> Back to Dashboard
      </button>
      <button class="my-creations-button" id="create-another-btn">
        <i data-lucide="palette"></i> Create Another
      </button>
      <div class="screen-container">
        <div class="collection-content">
          <div class="collection-title-section">
            <h1 class="collection-title">My Creations</h1>
            <p class="collection-subtitle">
              Your beautiful Squishmallow designs and artwork!
            </p>
          </div>

          <div class="collection-stats">
            <div class="stat-badge">
              <span class="stat-number" id="creations-count">0</span>
              <span class="stat-label">Creations</span>
            </div>
            <div class="stat-badge">
              <span class="stat-number" id="drafts-count">0</span>
              <span class="stat-label">Drafts</span>
            </div>
            <div class="stat-badge">
              <span class="stat-number" id="finished-count">0</span>
              <span class="stat-label">Finished</span>
            </div>
          </div>

          <div class="creations-grid" id="creations-grid">
            <!-- Creations will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- Story 7.4: Mascot Selection Modal -->
    <div
      id="mascot-selection-modal"
      class="modal-overlay"
      style="display: none"
    >
      <div class="modal-content">
        <div class="modal-header">
          <h2 class="modal-title">
            <i data-lucide="heart"></i>
            Choose Your Dashboard Companion
            <i data-lucide="heart"></i>
          </h2>
          <button class="modal-close-btn" id="mascot-modal-close" title="Close">
            <i data-lucide="x"></i>
          </button>
        </div>
        <div class="modal-body">
          <p class="modal-description">
            Select a Squishmallow from your collection as your dashboard
            companion!
          </p>
          <div class="mascot-selection-grid" id="mascot-selection-grid">
            <!-- Mascots will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript Files -->
    <!-- Load MathEngine first (Story 2.1) -->
    <script src="js/math-engine.js"></script>
    <!-- Load Collection Manager (Story 4.1) -->
    <script src="js/collection-manager.js"></script>
    <!-- Load Sound Manager (Story 6.2) -->
    <script src="js/sound-manager.js"></script>
    <!-- Main Application -->
    <script src="js/main.js"></script>

    <!-- Initialize Lucide Icons -->
    <script>
      lucide.createIcons();
    </script>
  </body>
</html>
